# Генератор обучающей выборки 
Изменение в работе с api сайта here.com:
Запрос `{{YOUR_APP_ID}}` и `{{YOUR_APP_CODE}}` сменился на запрос `{{YOUR_API_KEY}}`

Описание полученных результатов работы скрипта:

- плитки изображений имеют значения `row` и `column` (вероятно позиция плитки на карте, так же возможна выдача широты и долготы левого верхнего угла плитки);
- изображение и маска в формате `jpg`;
- возможные разрешения изображения: `128*128` `256*256` `512*512`;
- координаты забиваются вручную в config файл;
- параметр `zoom` отвечает за приближение спутникового снимка (на мой взгляд оптимальные приближения начинаются с значения 15 и выше до 19, приближение 14 и ниже дает изображения и маски низкого качества);
- дата съемки: в документации на сайте существуют способы выкачивания спутниковых снимков с различными погодными условиями, величиной трафика и датой создания (в данном скрипте используется `newest/satellite.day`, то есть выкачиваются новейшие снятые изобряжения).

### Снимок и маска с метками building(белый), nature(черный):
<p>
<img src='dataset_building\15_11309_17235.jpg' width='250'>
<img src='dataset_building\15_11309_17235_m.jpg' width='250'>
</p>

### Снимок и маска с метками building(белый), railway(красный), highway(зеленый), water(синий), nature(черный): 
<p>
<img src='dataset\15_11323_17221.jpg' width='250'>
<img src='dataset\15_11323_17221_m.jpg' width='250'>
</p>

Замечания по качеству масок:
- плохое качество сегментации автомобильных дорог (появляются артефакты там, где они вообще не должны быть);
- сегментация зданий: кое-где существуют небольшие неточности в форме или площади зданий, но в целом маски не съезжают со своих снимков и практически точно отображают местоположение зданий на реальном снимке.

# UPD:
Ответ от overpass-api возможен в двух форматах `body` и `geom` (их полные версии в папке `jsons`)

### body
```java
"elements": [
    {
      "type": "way",
      "id": 29984508,
      "nodes": [
        330087169,
        330087174,
        330087179,
        330087180,
        330087182,
        4959235974,
        4959235975,
        330087183,
        4959235976,
        4959235977,
        4959235978,
        4959235979,
        330087169
      ],
      "tags": {
        "addr:city": "Frickenhausen",
        "addr:country": "DE",
        "addr:housenumber": "11/1",
        "addr:postcode": "72636",
        "addr:street": "Im Dorf",
        "building": "yes"
      }
    },

    ...

    {
      "type": "node",
      "id": 2889270628,
      "lat": 48.5897945,
      "lon": 9.3643428
    },
    {
      "type": "node",
      "id": 2889270629,
      "lat": 48.5899697,
      "lon": 9.3644925
    },
    {
      "type": "node",
      "id": 2889270630,
      "lat": 48.5898587,
      "lon": 9.364575
    }
    ]
```

### geom
```java
"elements": [
    {
      "type": "way",
      "id": 29984508,
      "bounds": {
        "minlat": 48.5922466,
        "minlon": 9.3598375,
        "maxlat": 48.5925119,
        "maxlon": 9.360271
      },
      "nodes": [
        330087169,
        330087174,
        330087179,
        330087180,
        330087182,
        4959235974,
        4959235975,
        330087183,
        4959235976,
        4959235977,
        4959235978,
        4959235979,
        330087169
      ],
      "geometry": [
        {
          "lat": 48.5922466,
          "lon": 9.3601465
        },
        {
          "lat": 48.5922866,
          "lon": 9.360271
        },
        {
          "lat": 48.5925119,
          "lon": 9.3601055
        },
        {
          "lat": 48.5924258,
          "lon": 9.3598375
        },
        {
          "lat": 48.5923055,
          "lon": 9.3599259
        },
        {
          "lat": 48.5923205,
          "lon": 9.3599726
        },
        {
          "lat": 48.5923379,
          "lon": 9.3599597
        },
        {
          "lat": 48.5923707,
          "lon": 9.3600619
        },
        {
          "lat": 48.5923312,
          "lon": 9.3600909
        },
        {
          "lat": 48.5923372,
          "lon": 9.3601096
        },
        {
          "lat": 48.5923079,
          "lon": 9.3601311
        },
        {
          "lat": 48.5923002,
          "lon": 9.3601071
        },
        {
          "lat": 48.5922466,
          "lon": 9.3601465
        }
      ],
      "tags": {
        "addr:city": "Frickenhausen",
        "addr:country": "DE",
        "addr:housenumber": "11/1",
        "addr:postcode": "72636",
        "addr:street": "Im Dorf",
        "building": "yes"
      }
    },

    ...

    {
      "type": "node",
      "id": 5999508698,
      "lat": 48.5961257,
      "lon": 9.3655336
    },
    {
      "type": "node",
      "id": 5999508699,
      "lat": 48.5962144,
      "lon": 9.3654504
    },
    {
      "type": "node",
      "id": 5999515104,
      "lat": 48.5962627,
      "lon": 9.3655681
    }
]
```

Сам скрипт работает с форматом `body`, при этом для координат:
```java
"top_left_location": {
            "latitude": 48.5943082383157,
            "longitude": 9.358132308179012
        },
        "bottom_right_location": {
            "latitude": 48.59144697501694,
            "longitude": 9.366534503508293
        },
```

скрипт выдает две плитки, которые, вероятно, вмещаются в эти координаты.
Результирующие изображения получаются следующими:

<p>
<img src='dataset_building\15_11309_17235.jpg' width='250'>
<img src='dataset_building\15_11309_17236.jpg' width='250'>
</p>
<p>
<img src='dataset_building\15_11309_17235_m.jpg' width='250'>
<img src='dataset_building\15_11309_17236_m.jpg' width='250'>
</p>

# UPD2:
Значения пикселей для узлов объектов записываются дополнительно в файл `.json` в `pixels`:
```java
"pixels": {
    "2888634673": [
      94,
      487
    ],
    "2888634674": [
      99,
      494
    ],
    "2888634675": [
      104,
      491
    ],
    "2888634676": [
      99,
      484
    ],

    ...
    }
```